import org.apache.poi.ss.usermodel.*;import org.apache.poi.xssf.usermodel.XSSFWorkbook;import javax.swing.*;import javax.swing.border.EmptyBorder;import javax.swing.table.DefaultTableCellRenderer;import javax.swing.table.DefaultTableModel;import java.awt.*;import java.io.File;import java.io.FileInputStream;import java.io.FileWriter;import java.util.ArrayList;import java.util.List;public class ExcelJFormApp extends JFrame {    private JTable table;    private JLabel maxLabel;    private JLabel sumLabel;    private DefaultTableModel tableModel;    // Жорстко заданий шлях до Excel файлу    private final String EXCEL_FILE_PATH = "C:\\Users\\Admin\\IdeaProjects\\JavaLab5\\src\\Data_excel.xlsx"; // <- заміни на свій файл    public static class Product {        String name;        double price;        int quantity;        double total;        public Product(String name, double price, int quantity) {            this.name = name;            this.price = price;            this.quantity = quantity;            this.total = price * quantity;        }    }    public ExcelJFormApp() {        setTitle("Excel Reader JForm");        setSize(850, 600);        setDefaultCloseOperation(EXIT_ON_CLOSE);        setLocationRelativeTo(null);        JPanel mainPanel = new JPanel(new BorderLayout(10, 10));        mainPanel.setBorder(new EmptyBorder(10, 10, 10, 10));        mainPanel.setBackground(new Color(250, 250, 250));        add(mainPanel);        tableModel = new DefaultTableModel(new String[]{"Товар", "Ціна", "Кількість", "Сума"}, 0);        table = new JTable(tableModel) {            public Component prepareRenderer(javax.swing.table.TableCellRenderer renderer, int row, int column) {                Component c = super.prepareRenderer(renderer, row, column);                if (!isRowSelected(row)) {                    c.setBackground(row % 2 == 0 ? new Color(245, 245, 255) : new Color(230, 240, 255));                }                return c;            }        };        table.setFillsViewportHeight(true);        table.setRowHeight(26);        table.setFont(new Font("Segoe UI", Font.PLAIN, 14));        table.getTableHeader().setFont(new Font("Segoe UI", Font.BOLD, 16));        table.getTableHeader().setBackground(new Color(100, 149, 237));        table.getTableHeader().setForeground(Color.WHITE);        DefaultTableCellRenderer centerRenderer = new DefaultTableCellRenderer();        centerRenderer.setHorizontalAlignment(JLabel.CENTER);        for (int i = 0; i < table.getColumnCount(); i++) {            table.getColumnModel().getColumn(i).setCellRenderer(centerRenderer);        }        mainPanel.add(new JScrollPane(table), BorderLayout.CENTER);        JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 20, 10));        buttonPanel.setBackground(new Color(250, 250, 250));        JButton loadButton = createStyledButton("Завантажити Excel", new Color(72, 209, 204)); // бірюзовий        JButton clearButton = createStyledButton("Очистити таблицю", new Color(255, 140, 0)); // темно-оранжевий        JButton saveButton = createStyledButton("Зберегти результати", new Color(60, 179, 113)); // зелений        buttonPanel.add(loadButton);        buttonPanel.add(clearButton);        buttonPanel.add(saveButton);        mainPanel.add(buttonPanel, BorderLayout.NORTH);        JPanel infoPanel = new JPanel(new GridLayout(2, 1, 10, 10));        infoPanel.setBorder(new EmptyBorder(10, 0, 0, 0));        infoPanel.setBackground(new Color(250, 250, 250));        maxLabel = new JLabel("Товар з максимальною сумою: ");        sumLabel = new JLabel("Загальна сума продажів: 0");        maxLabel.setFont(new Font("Segoe UI", Font.BOLD, 16));        maxLabel.setForeground(new Color(33, 33, 33));        sumLabel.setFont(new Font("Segoe UI", Font.BOLD, 16));        sumLabel.setForeground(new Color(33, 33, 33));        infoPanel.add(maxLabel);        infoPanel.add(sumLabel);        mainPanel.add(infoPanel, BorderLayout.SOUTH);        // Дії кнопок        loadButton.addActionListener(e -> loadExcel());        clearButton.addActionListener(e -> clearTable());        saveButton.addActionListener(e -> saveResults());        setVisible(true);    }    private JButton createStyledButton(String text, Color bgColor) {        JButton button = new JButton(text);        button.setForeground(Color.WHITE);        button.setFont(new Font("Segoe UI", Font.BOLD, 14));        button.setBackground(bgColor);        button.setFocusPainted(false);        button.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 2));        button.setPreferredSize(new Dimension(220, 45));        return button;    }    private void loadExcel() {        File file = new File(EXCEL_FILE_PATH);        if (!file.exists()) {            JOptionPane.showMessageDialog(this, "Файл не знайдено: " + EXCEL_FILE_PATH);            return;        }        List<Product> products = readExcel(file);        tableModel.setRowCount(0);        for (Product p : products) {            tableModel.addRow(new Object[]{p.name, p.price, p.quantity, p.total});        }        Product maxProduct = products.stream()                .max((p1, p2) -> Double.compare(p1.total, p2.total))                .orElse(null);        if (maxProduct != null) {            maxLabel.setText("Товар з максимальною сумою: " + maxProduct.name + " = " + maxProduct.total);        }        double sum = products.stream().mapToDouble(p -> p.total).sum();        sumLabel.setText("Загальна сума продажів: " + sum);    }    private void clearTable() {        tableModel.setRowCount(0);        maxLabel.setText("Товар з максимальною сумою: ");        sumLabel.setText("Загальна сума продажів: 0");    }    private void saveResults() {        JFileChooser fileChooser = new JFileChooser();        int result = fileChooser.showSaveDialog(this);        if (result == JFileChooser.APPROVE_OPTION) {            File file = fileChooser.getSelectedFile();            try (FileWriter writer = new FileWriter(file)) {                for (int i = 0; i < tableModel.getRowCount(); i++) {                    for (int j = 0; j < tableModel.getColumnCount(); j++) {                        writer.write(tableModel.getValueAt(i, j).toString());                        if (j < tableModel.getColumnCount() - 1) writer.write(",");                    }                    writer.write("\n");                }                JOptionPane.showMessageDialog(this, "Результати збережено!");            } catch (Exception e) {                e.printStackTrace();                JOptionPane.showMessageDialog(this, "Помилка при збереженні!");            }        }    }    private List<Product> readExcel(File file) {        List<Product> products = new ArrayList<>();        try (FileInputStream fis = new FileInputStream(file);             Workbook workbook = new XSSFWorkbook(fis)) {            Sheet sheet = workbook.getSheetAt(0);            boolean firstRow = true;            for (Row row : sheet) {                if (firstRow) {                    firstRow = false;                    continue;                }                String name = row.getCell(0).getStringCellValue();                double price = row.getCell(1).getNumericCellValue();                int quantity = (int) row.getCell(2).getNumericCellValue();                products.add(new Product(name, price, quantity));            }        } catch (Exception e) {            e.printStackTrace();        }        return products;    }    public static void main(String[] args) {        SwingUtilities.invokeLater(ExcelJFormApp::new);    }}